================================================================================
GU√çA DE PRUEBA - SISTEMA DE CORRECCIONES MEJORADO
================================================================================

üéØ OBJETIVO DE LA PRUEBA
--------------------------------------------------------------------------------
Verificar que:
1. Los campos de archivos (especialmente certificado_eps_nino) se marquen 
   correctamente con badge "CORREGIR" y resaltado naranja
2. El sistema de 3 intentos funcione correctamente
3. Los emails incluyan el mensaje de advertencia de intentos


üìã PASOS PARA PROBAR
--------------------------------------------------------------------------------

PASO 1: ACCEDER AL PANEL DE REVISI√ìN
-------------------------------------
1. Iniciar sesi√≥n como Valentina Ramirez:
   - Email: valentinarm124@gmail.com
   - Password: (tu contrase√±a de madre)

2. Ir a la p√°gina de Matr√≠culas

3. Click en bot√≥n "Panel de Revisi√≥n" (con badge mostrando cantidad)

4. Deber√≠as ver la p√°gina dedicada con:
   ‚úì Estad√≠sticas arriba (Total, Completos, Sin completar, Correcci√≥n)
   ‚úì Filtros (Todas, Completas, Sin completar, Correcci√≥n)
   ‚úì Lista de solicitudes


PASO 2: SOLICITAR CORRECCI√ìN DEL CERTIFICADO EPS
-------------------------------------------------
1. Buscar una solicitud completa (por ejemplo, "carlitos" ID 1)

2. Click en bot√≥n "Solicitar Correcci√≥n"

3. Marcar el checkbox "Certificado EPS" ‚úì
   (Tambi√©n puedes marcar otros campos para probar)

4. Click "Enviar para Correcci√≥n"

5. Verificar mensaje de √©xito:
   "Se solicit√≥ correcci√≥n de 1 campo(s). El acudiente fue notificado."


PASO 3: VERIFICAR EMAIL ENVIADO
--------------------------------
1. Revisar bandeja de entrada del email del acudiente
   (stivnieto14@gmail.com en este caso)

2. Verificar que el email contiene:
   ‚úì Lista de campos a corregir (debe incluir "Certificado EPS")
   ‚úì Bloque amarillo "IMPORTANTE - L√≠mite de Intentos"
   ‚úì Texto: "Solo tiene 3 intentos para corregir..."
   ‚úì Contador: "Intentos usados: 1 de 3"
   ‚úì Contador: "Intentos restantes: 2"
   ‚úì Advertencia: "Si excede los 3 intentos, deber√° solicitar nuevamente"
   ‚úì Bot√≥n "Corregir Formulario" con link


PASO 4: ABRIR FORMULARIO DE CORRECCI√ìN
---------------------------------------
1. Click en el bot√≥n "Corregir Formulario" del email

2. El formulario debe mostrar:
   ‚úì Secci√≥n "Documentos Requeridos"
   ‚úì Campo "Certificado EPS" con badge naranja "CORREGIR"
   ‚úì Borde naranja alrededor del campo
   ‚úì Fondo amarillo claro
   ‚úì ANIMACI√ìN DE PULSO visible (el campo parpadea sutilmente)

3. Verificar que otros campos SIN correcci√≥n est√°n normales (sin badge)


PASO 5: PROBAR SEGUNDA CORRECCI√ìN
----------------------------------
1. Volver al Panel de Revisi√≥n

2. Buscar la misma solicitud (ahora debe estar en estado "correcci√≥n")

3. Click "Solicitar Correcci√≥n" nuevamente

4. Marcar otros campos (por ejemplo, "Foto del ni√±o", "Carnet de vacunaci√≥n")

5. Enviar para correcci√≥n

6. Verificar nuevo email:
   ‚úì Contador: "Intentos usados: 2 de 3"
   ‚úì Contador: "Intentos restantes: 1"


PASO 6: PROBAR TERCERA CORRECCI√ìN (√öLTIMA)
-------------------------------------------
1. Repetir proceso una vez m√°s

2. Verificar email:
   ‚úì Contador: "Intentos usados: 3 de 3"
   ‚úì Contador: "Intentos restantes: 0"
   ‚úì Mensaje de advertencia m√°s cr√≠tico


PASO 7: PROBAR L√çMITE DE INTENTOS
----------------------------------
1. Intentar solicitar correcci√≥n por CUARTA vez

2. Verificar que aparece mensaje de error:
   "Esta solicitud ya excedi√≥ el l√≠mite de 3 intentos de correcci√≥n.
    El acudiente debe enviar una nueva solicitud."

3. El sistema NO debe permitir m√°s correcciones


üìä VERIFICAR CON SCRIPTS
--------------------------------------------------------------------------------

1. Ver estado de todas las solicitudes:
   python verificar_correcciones.py

   Deber√≠as ver:
   - Solicitud ID con intentos incrementados
   - Campos marcados para correcci√≥n
   - Intentos restantes

2. Ver demostraci√≥n visual:
   python demo_correcciones.py

   Muestra una vista previa de:
   - Contador de intentos con barra visual
   - Campos marcados
   - Preview del email
   - Preview del formulario


üêõ TROUBLESHOOTING
--------------------------------------------------------------------------------

PROBLEMA: El campo no se resalta en naranja
SOLUCI√ìN: Verificar que el campo est√© en la lista campos_corregir
          python verificar_correcciones.py

PROBLEMA: No aparece el badge "CORREGIR"
SOLUCI√ìN: Limpiar cach√© del navegador (Ctrl+Shift+R)

PROBLEMA: Email no incluye mensaje de intentos
SOLUCI√ìN: Verificar que la vista devolver_correccion_matricula 
          est√© pasando intentos_usados e intentos_restantes al contexto

PROBLEMA: No se incrementa el contador
SOLUCI√ìN: Verificar que la migraci√≥n se aplic√≥ correctamente
          python manage.py showmigrations core
          (debe mostrar [X] 0025_solicitudmatriculacion_intentos_correccion)


‚úÖ CHECKLIST DE VERIFICACI√ìN
--------------------------------------------------------------------------------
‚ñ° Badge "CORREGIR" aparece en campos de archivos marcados
‚ñ° Campos de archivos tienen borde naranja cuando est√°n en correcci√≥n
‚ñ° Animaci√≥n de pulso visible en campos marcados
‚ñ° Email incluye bloque "IMPORTANTE - L√≠mite de Intentos"
‚ñ° Email muestra contador "X de 3 intentos"
‚ñ° Contador se incrementa con cada correcci√≥n
‚ñ° Sistema bloquea correcciones despu√©s del 3er intento
‚ñ° Mensaje de error claro cuando se excede el l√≠mite
‚ñ° Formulario p√∫blico muestra correctamente los campos marcados
‚ñ° Todos los tipos de archivos funcionan (foto, carnet, eps, registro, cedula, sisben)


üìß EMAILS DE PRUEBA
--------------------------------------------------------------------------------
Acudientes disponibles para pruebas:
- stivnieto14@gmail.com (tiene varias solicitudes)
- valentinarm124@gmail.com (tiene 1 solicitud)


üîÑ RESETEAR PRUEBAS
--------------------------------------------------------------------------------
Para resetear contador de intentos de una solicitud:

python manage.py shell

>>> from core.models import SolicitudMatriculacion
>>> sol = SolicitudMatriculacion.objects.get(id=6)
>>> sol.intentos_correccion = 0
>>> sol.save()
>>> exit()


================================================================================
FIN DE LA GU√çA
================================================================================
